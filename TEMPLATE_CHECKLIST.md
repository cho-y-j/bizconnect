# 템플릿 기능 확인 체크리스트

## ✅ 확인 단계

### 1단계: 데이터베이스 마이그레이션 확인

#### 방법 1: API로 확인
브라우저에서 다음 URL 접속:
```
http://localhost:3000/api/check-templates
```

**예상 결과:**
- ✅ 성공: `{"success": true, "message": "템플릿 테이블이 정상적으로 설정되었습니다."}`
- ❌ 실패: `{"success": false, "message": "message_templates 테이블이 존재하지 않습니다."}`

#### 방법 2: Supabase Dashboard에서 확인
1. Supabase Dashboard 접속
2. 왼쪽 메뉴 > "Table Editor" 클릭
3. `message_templates` 테이블이 있는지 확인
4. `tasks` 테이블을 열어서 `template_id` 컬럼이 있는지 확인

---

### 2단계: 템플릿 관리 페이지 확인

1. 웹 앱 실행 (`npm run dev`)
2. 로그인
3. `/dashboard/templates` 페이지 접속
4. 다음 확인:
   - [ ] 페이지가 정상적으로 로드됨
   - [ ] "템플릿 추가" 버튼이 보임
   - [ ] 에러 메시지가 없음

**예상 화면:**
- 템플릿이 없으면: "등록된 템플릿이 없습니다." 메시지
- 템플릿이 있으면: 템플릿 카드 목록

---

### 3단계: 템플릿 추가 테스트

1. `/dashboard/templates` 페이지에서 "+ 템플릿 추가" 클릭
2. 다음 정보 입력:
   - **템플릿 이름**: "테스트 템플릿"
   - **카테고리**: "일반"
   - **템플릿 내용**: `{고객명}님 안녕하세요! 오늘은 {날짜} {요일}입니다.`
   - **즐겨찾기**: 체크 (선택)
3. "추가" 버튼 클릭
4. 확인:
   - [ ] 템플릿이 목록에 추가됨
   - [ ] 변수가 자동으로 감지되어 표시됨 (`{고객명}`, `{날짜}`, `{요일}`)
   - [ ] 에러가 없음

---

### 4단계: 문자 보내기 페이지에서 템플릿 사용

1. `/dashboard/send` 페이지 접속
2. 확인:
   - [ ] "템플릿 선택" 드롭다운이 보임
   - [ ] 방금 추가한 템플릿이 목록에 있음
3. 템플릿 선택:
   - 드롭다운에서 "테스트 템플릿" 선택
   - [ ] 메시지 입력란에 템플릿 내용이 자동으로 입력됨
4. 발송 모드 선택:
   - "단건 발송" 선택
   - 고객명 입력: "홍길동"
   - 전화번호 입력: "010-1234-5678"
5. 미리보기 확인:
   - [ ] 미리보기 섹션이 나타남
   - [ ] `{고객명}` → "홍길동"으로 치환됨
   - [ ] `{날짜}` → 오늘 날짜로 치환됨
   - [ ] `{요일}` → 오늘 요일로 치환됨

---

### 5단계: 고객 검색 기능 확인 (다중 발송)

1. `/dashboard/send` 페이지 접속
2. "다중 발송" 모드 선택
3. 확인:
   - [ ] 고객 목록이 로드됨
   - [ ] 검색 입력란이 보임
4. 검색 테스트:
   - 검색창에 고객 이름 입력
   - [ ] 검색 결과가 실시간으로 필터링됨
   - 검색창에 전화번호 입력
   - [ ] 전화번호로도 검색됨

---

### 6단계: 변수 치환 확인

#### 사용 가능한 변수 목록
- [ ] `{고객명}` - 고객 이름
- [ ] `{날짜}` - 오늘 날짜
- [ ] `{시간}` - 현재 시간
- [ ] `{전화번호}` - 고객 전화번호
- [ ] `{업종}` - 고객 업종
- [ ] `{그룹명}` - 고객 그룹 이름
- [ ] `{태그}` - 고객 태그
- [ ] `{생일}` - 고객 생일
- [ ] `{기념일}` - 고객 기념일
- [ ] `{요일}` - 오늘 요일

#### 테스트 방법
1. 템플릿에 모든 변수 포함:
```
{고객명}님 안녕하세요!
오늘은 {날짜} {요일} {시간}입니다.
전화번호: {전화번호}
업종: {업종}
그룹: {그룹명}
태그: {태그}
생일: {생일}
기념일: {기념일}
```

2. 고객 정보가 있는 고객으로 테스트
3. 미리보기에서 모든 변수가 치환되는지 확인

---

## 🐛 문제 해결

### 문제 1: "message_templates 테이블이 존재하지 않습니다"
**해결:**
1. `supabase/add-message-templates.sql` 파일 열기
2. Supabase Dashboard > SQL Editor 접속
3. SQL 파일 내용 복사하여 붙여넣기
4. "Run" 버튼 클릭

### 문제 2: 템플릿 관리 페이지에서 에러 발생
**확인 사항:**
- 브라우저 콘솔(F12)에서 에러 메시지 확인
- 네트워크 탭에서 API 요청 실패 확인
- Supabase 연결 상태 확인

### 문제 3: 템플릿 선택이 안 됨
**확인 사항:**
- 템플릿이 실제로 추가되었는지 확인
- 브라우저 콘솔에서 에러 확인
- `useMessageTemplates` 훅이 정상 작동하는지 확인

### 문제 4: 변수가 치환되지 않음
**확인 사항:**
- 변수 이름이 정확한지 확인 (대소문자, 중괄호)
- 고객 정보가 제대로 로드되었는지 확인
- `templateParser.ts`의 `replaceTemplateVariables` 함수 확인

---

## 📝 테스트 시나리오

### 시나리오 1: 기본 템플릿 생성 및 사용
1. 템플릿 생성: "인사말" - `{고객명}님 안녕하세요!`
2. 문자 보내기에서 템플릿 선택
3. 단건 발송으로 테스트
4. 미리보기에서 `{고객명}`이 실제 이름으로 치환되는지 확인

### 시나리오 2: 복잡한 변수 조합
1. 템플릿 생성: "생일 축하" - `{고객명}님, 생일을 진심으로 축하드립니다! 오늘은 {날짜} {요일}입니다.`
2. 생일 정보가 있는 고객으로 테스트
3. 모든 변수가 치환되는지 확인

### 시나리오 3: 그룹별 발송
1. 그룹이 있는 고객들로 그룹 생성
2. 템플릿에 `{그룹명}` 변수 포함
3. 그룹별 발송 모드로 테스트
4. 각 고객의 그룹명이 올바르게 치환되는지 확인

---

## ✅ 완료 체크

모든 단계를 완료했으면:

- [ ] 데이터베이스 마이그레이션 실행 완료
- [ ] 템플릿 관리 페이지 접속 성공
- [ ] 템플릿 추가 성공
- [ ] 템플릿 수정 성공
- [ ] 템플릿 삭제 성공
- [ ] 문자 보내기에서 템플릿 선택 성공
- [ ] 변수 치환 정상 작동
- [ ] 고객 검색 기능 정상 작동
- [ ] 미리보기 정상 작동

---

## 🎉 완료!

모든 체크리스트를 완료했다면 템플릿 기능이 정상적으로 작동하는 것입니다!

다음 단계:
- 실제 사용 시나리오로 테스트
- 다양한 템플릿 생성
- 팀원들과 공유

