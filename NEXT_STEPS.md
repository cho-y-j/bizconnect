# 다음 단계 작업 계획

**작성일:** 2025.12.05  
**현재 상태:** 웹 대시보드 대부분 완성, 모바일 앱 기본 구조만 존재

---

## 📊 현재 완료된 항목

### ✅ 웹 대시보드 (거의 완성)
- [x] 인증 시스템 (로그인/회원가입/구글 OAuth)
- [x] 고객 관리 (그룹, 태그, CSV 업로드)
- [x] 문자 발송 UI (단건/다중/그룹/태그, 템플릿, 예약)
- [x] 발송 기록 조회
- [x] 메시지 템플릿 관리
- [x] 이미지 관리 (명함, 로고 등)
- [x] AI 메시지 추천
- [x] 대화 요약
- [x] 개인정보 상세 입력
- [x] 명함 설정

### ⚠️ 웹 대시보드 (미완성)
- [ ] **콜백 서비스 설정 화면** (중요!)
- [ ] 기본 설정 (일일 한도, 스로틀링 간격 등)

### ❌ 모바일 앱 (기본 구조만)
- [x] 기본 구조
- [x] Supabase 연동
- [x] 통화 감지 기능 (기본)
- [ ] **스로틀링 큐 시스템** (15초 간격)
- [ ] **일일 한도 제어** (199건/490건)
- [ ] **스마트 콜백 로직** (신규/기존 고객 구분)
- [ ] **실제 SMS 발송 처리**
- [ ] **sms_logs 기록**

---

## 🎯 다음 단계 우선순위

### 1단계: 콜백 서비스 설정 화면 완성 (웹) ⭐⭐⭐
**왜 먼저?**
- 모바일 앱에서 콜백 기능을 구현하려면 템플릿이 필요함
- 웹에서 템플릿을 설정할 수 있어야 모바일 앱 개발 가능
- `user_settings` 테이블에 이미 필드가 있음 (`callback_template_new`, `callback_template_existing`)

**작업 내용:**
1. 설정 페이지에 "콜백 서비스" 섹션 추가
2. 콜백 활성화/비활성화 토글
3. 신규 고객 콜백 템플릿 입력
4. 기존 고객 콜백 템플릿 입력
5. 템플릿 미리보기
6. 변수 치환 지원 ({고객명}, {날짜} 등)

**예상 소요 시간:** 2-3시간

---

### 2단계: 기본 설정 화면 완성 (웹) ⭐⭐
**작업 내용:**
1. 일일 한도 모드 선택 (안전 모드 199건 / 최대 모드 490건)
2. 스로틀링 간격 설정 (기본 15초)
3. 업종 선택 (보험, 자동차, 부동산 등)
4. 설정 저장 및 적용

**예상 소요 시간:** 1-2시간

---

### 3단계: 모바일 앱 개발 시작 ⭐⭐⭐
**왜 이제?**
- 웹에서 모든 설정이 완료되면 모바일 앱이 그 설정을 읽어서 사용 가능
- 콜백 템플릿이 준비되어야 콜백 기능 구현 가능

**작업 순서:**
1. **스로틀링 큐 시스템** (최우선)
   - 15초 간격으로 SMS 발송
   - 큐 관리 및 재시도 로직
   
2. **일일 한도 제어**
   - `daily_limits` 테이블과 동기화
   - 한도 초과 시 자동 차단
   
3. **실제 SMS 발송 처리**
   - `tasks` 테이블 읽기
   - SMS 발송 후 `sms_logs` 기록
   - `tasks` 상태 업데이트
   
4. **스마트 콜백 로직**
   - 통화 종료 감지
   - 고객 DB 조회 (신규/기존 구분)
   - 설정된 템플릿으로 자동 발송

**예상 소요 시간:** 각 항목당 6-10시간

---

## 📋 상세 작업 체크리스트

### 콜백 서비스 설정 화면
- [ ] 설정 페이지에 "콜백 서비스" 섹션 추가
- [ ] 콜백 활성화/비활성화 토글
- [ ] 신규 고객 콜백 템플릿 입력 필드
- [ ] 기존 고객 콜백 템플릿 입력 필드
- [ ] 템플릿 변수 안내 ({고객명}, {날짜}, {회사명} 등)
- [ ] 템플릿 미리보기 기능
- [ ] 저장 및 적용 확인

### 기본 설정 화면
- [ ] 일일 한도 모드 선택 (안전/최대)
- [ ] 스로틀링 간격 설정 (초 단위)
- [ ] 업종 선택 드롭다운
- [ ] 설정 저장 및 적용

### 모바일 앱 개발
- [ ] 스로틀링 큐 시스템 구현
- [ ] 일일 한도 제어 구현
- [ ] SMS 발송 처리 구현
- [ ] sms_logs 기록 구현
- [ ] 스마트 콜백 로직 구현
- [ ] 실제 디바이스 테스트

---

## 💡 권장 작업 순서

### 오늘/내일 할 일:
1. ✅ **콜백 서비스 설정 화면 완성** (2-3시간)
2. ✅ **기본 설정 화면 완성** (1-2시간)

### 그 다음:
3. ✅ **모바일 앱 개발 시작**
   - 스로틀링 큐 시스템부터 시작
   - 하나씩 단계적으로 구현

---

## 🎯 결론

**지금 바로 할 일:**
1. **콜백 서비스 설정 화면** 만들기 (웹)
2. **기본 설정 화면** 완성하기 (웹)

**그 다음:**
3. **모바일 앱 개발** 시작 (스로틀링 큐 시스템부터)

**이유:**
- 웹에서 모든 설정이 완료되어야 모바일 앱이 그 설정을 사용할 수 있음
- 콜백 템플릿이 준비되어야 모바일 앱에서 콜백 기능 구현 가능
- 설정 화면은 빠르게 완성 가능 (2-4시간)
- 모바일 앱 개발은 시간이 더 걸림 (각 기능당 6-10시간)

---

**다음 작업을 시작할까요?**
1. 콜백 서비스 설정 화면 만들기
2. 기본 설정 화면 완성하기
3. 둘 다 한번에 만들기
